# MySQL事务 & MVCC & 锁

## 事务

### 1.支持事务的存储引擎有

InnoDB（MySQL默认的存储引擎）
NDB（该存储引擎常用于集群）

### 2.事务三大特性ACID

A （Automicity）：原子性。事务是数据库操作中最小的逻辑单位，要不全部成功，要不就全部操作都失败。
C （Consistant）：一致性。
I （Isolation）：隔离性。
D （Durable）：持久性。（数据是先写到binlog里，）

PS：AID的实现其实都是为了实现C（一致性）。

### 3.并发事务所带来的问题

#### 脏读
在同一个事务中，执行相同的查询语句，得到不同的数据，因为读取别的事务<b>"未提交"</b>的数据造成的。

#### 不可重复度
在同一个事务中，执行相同的查询语句，得到不同的数据，该数据是因为读取了别的事务<b>"已提交"</b>的数据造成的。（删除 & 修改的数据都属于不可重复读的范畴）

#### 幻读
在同一个事务中，执行两次相同查询语句，读取到别的事务<b>"新增"</b>的数据。

### 4.解决并发事务问题：事务隔离级别
// PS：事务级别只是数据库的标准，实现的话根据各个数据库产商自己的具体实现


##### 读未提交 RU（Read Uncommited）
事务可以读取其他事务未提交的数据库操作（可以解决脏读）

##### 读已提交 RC(Read Committed)
事务只能读取别的事务已提交的数据库操作（可以解决 不可重复读）

##### 重复读（Repeatable read）


| 事务隔离级别 | 脏读 | 不可重复度 | 幻读 |
| ----------- | ---- | --------- | --- |
| 读未提交 RU（Read Uncommited）  | × | × | × |
| 读已提交 RC(Read Committed)    | √ | × | × |
| 重复读（Repeatable read）      | √ | √ | ×（MySQL InnoDB） |
| 串行化（serializer）           | √ | √ | √ |


解决事务